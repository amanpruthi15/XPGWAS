# XP-GWAS Pipeline (Input Generation + Association Testing)

This repository contains a **two-step XP-GWAS pipeline** designed for large-scale genotype datasets (millions of SNPs) that cannot be loaded into memory at once.

The workflow is:
1. **Generate XP-GWAS input files** from raw genotype + phenotype data
2. **Run XP-GWAS** using the generated inputs

This pipeline is optimized for HPC usage and large datasets.

---

## Requirements

- R (≥ 4.0 recommended)
- XP-GWAS package installed
- Sufficient disk space (intermediate files are written to disk)
- Genotype data in **numeric / HapMap-derived numeric format**
- Phenotype file with matching sample IDs

---

## Directory Structure

```text
project/
├── scripts/
│   ├── generate_xpgwas_input.R
│   └── run_xpgwas.R
├── genotype/
│   └── genotype_numeric.txt
├── phenotype/
│   └── phenotype.txt
├── xpgwas_input/
├── xpgwas_output/
```
---

## Script 1: Generate XP-GWAS Input

This script converts a large numeric genotype file into **XP-GWAS-ready input files** by splitting SNPs into manageable chunks.

### Usage

```bash
Rscript generate_xpgwas_input.R \
  genotype/genotype_numeric.txt \
  phenotype/phenotype.txt \
  TraitName \
  5000 \
  xpgwas_input
```

###  Arguments

- genotype_numeric.txt	--> Numeric genotype file (samples × SNPs)
- phenotype.txt -->	Phenotype file with sample IDs
- TraitName	--> Trait to analyze
- 5000	--> SNPs per chunk (recommended: 5,000–10,000)
- xpgwas_input -->	Output directory for XP-GWAS input files
---
## Script 2: Run XP-GWAS (Argument-Based)

This script runs XP-GWAS using the pre-generated chunked input files.
All paths and parameters are provided via command-line arguments — no hard-coded values.

### Usage

```bash
Rscript run_xpgwas.R \
  xpgwas_input \
  TraitName \
  0.05 \
  xpgwas_output
```
###  Arguments

- xpgwas_input -->	Directory generated by Script 1
- TraitName -->	Trait name (must match input generation)
- 0.05 -->	Significance threshold (p-value or FDR cutoff)
- xpgwas_output	--> Output directory for XP-GWAS results

---

## Notes
SNP chunking is mandatory for large genotype files (millions of markers).

Recommended chunk size: 5,000–10,000 SNPs.

XP-GWAS results should be aggregated and visualized after all chunks finish running.
